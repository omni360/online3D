
ï»¿var skydrive=(new function(){"use strict";var _this=this;var selected,downloaded;function onDownloadFileCompleted(response){var msg="";if(response.data.folders.length>0){for(folder=0;folder<response.data.folders.length;folder++){msg+="\n"+response.data.folders[folder].id;}}
if(response.data.files.length>0){for(file=0;file<response.data.files.length;file++){msg+="\n"+response.data.files[file].id;}}};function onDownloadFileError(responseFailed){}
_this.showUI=function(selectCallback,fileLoadedCallback){WL.init({client_id:"00000000480EF140",redirect_uri:"http://online3d.apphb.com"});WL.login({"scope":"wl.skydrive wl.signin"}).then(function(response){openFromSkyDrive();},function(response){log("Failed to authenticate.");});function openFromSkyDrive(){WL.fileDialog({mode:'open',select:'single'}).then(function(response){log("The following file is being downloaded:");log("");var files=response.data.files;for(var i=0;i<files.length;i++){var file=files[i];log(file.name);WL.download({"path":file.id+"/content"});}},function(errorResponse){log("WL.fileDialog errorResponse = "+JSON.stringify(errorResponse));});}
function log(message){var child=document.createTextNode(message);var parent=document.getElementById('JsOutputDiv')||document.body;parent.appendChild(child);parent.appendChild(document.createElement("br"));}
function onDownloadFileCompleted(response){var msg="";if(response.data.folders.length>0){for(folder=0;folder<response.data.folders.length;folder++){msg+="\n"+response.data.folders[folder].id;}}
if(response.data.files.length>0){for(file=0;file<response.data.files.length;file++){msg+="\n"+response.data.files[file].id;}}
log(msg);};}})